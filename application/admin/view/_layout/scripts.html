<!-- jQuery -->
{js href="/static/jquery/jquery.min.js" /}
<!-- jQuery UI 1.11.4 -->
{js href="__JS__/jquery-ui.min.js" /}
<!-- Bootstrap 4 -->
{js  href="__PLUGINS__/bootstrap/js/bootstrap.bundle.min.js" /}
{js href="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" /}
<!-- DataTables -->
{js  href="__PLUGINS__/datatables/jquery.dataTables.js" /}
{js  href="__PLUGINS__/datatables/dataTables.bootstrap4.js" /}
<!-- Morris.js charts -->
{js href="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js" /}
{js  href="__PLUGINS__/morris/morris.min.js" /}
<!-- jvectormap -->
{js  href="__PLUGINS__/jvectormap/jquery-jvectormap-1.2.2.min.js" /}
{js  href="__PLUGINS__/jvectormap/jquery-jvectormap-world-mill-en.js" /}
<!-- jQuery Knob Chart -->
{js  href="__PLUGINS__/knob/jquery.knob.js" /}
<!-- datepicker -->
{js  href="__PLUGINS__/datepicker/bootstrap-datepicker.js" /}
<!-- Bootstrap WYSIHTML5 -->
{js  href="__PLUGINS__/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js" /}
<!-- Slimscroll -->
{js  href="__PLUGINS__/slimScroll/jquery.slimscroll.min.js" /}
<!-- FastClick -->
{js  href="__PLUGINS__/fastclick/fastclick.js" /}
<!-- AdminLTE App -->
{js  href="__JS__/adminlte.js" /}
<!-- iCheck 1.0.1 -->
{js  href="__PLUGINS__/iCheck/icheck.min.js" /}
<!-- ECharts -->
{js  href="__PLUGINS__/eCharts/echarts.min.js" /}
<!-- Select2 -->
{js  href="__PLUGINS__/select2/select2.full.min.js" /}
<!-- date-range-picker -->
{js  href="__PLUGINS__/daterangepicker/moment.min.js" /}
{js  href="__PLUGINS__/daterangepicker/daterangepicker.js" /}
<!-- Editor -->
{js  href="__PLUGINS__/datatables/extensions/Editor/js/dataTables.editor.min.js" /}
{js  href="__PLUGINS__/datatables/extensions/Editor/js/editor.bootstrap4.js" /}
<!-- KeyTable -->
{js  href="__PLUGINS__/datatables/extensions/KeyTable/js/dataTables.keyTable.min.js" /}
{js  href="__PLUGINS__/datatables/extensions/KeyTable/js/keyTable.bootstrap4.min.js" /}
<!-- Buttons -->
{js  href="__PLUGINS__/datatables/extensions/Buttons/js/dataTables.buttons.min.js" /}
{js  href="__PLUGINS__/datatables/extensions/Buttons/js/buttons.bootstrap4.js" /}
<!-- Select -->
{js  href="__PLUGINS__/datatables/extensions/Select/js/dataTables.select.min.js" /}
{js  href="__PLUGINS__/datatables/extensions/Select/js/select.bootstrap4.js" /}
<!-- RowGroup -->
{js href="__PLUGINS__/datatables/extensions/Rowgroup/js/rowGroup.bootstrap4.js" /}
{js href="__PLUGINS__/datatables/extensions/Rowgroup/js/dataTables.rowGroup.min.js" /}
<script>
    // 初始化echarts实例
    var barChart = echarts.init(document.getElementById('bar-chart'));
    var option = {
        tooltip : {
            trigger: 'axis'
        },
        legend: {
            data:['类型1','类型2'],
            right: 5,
            orient: 'vertical',
        },
        toolbox: {
            show : false,
            feature : {
                dataView : {show: true, readOnly: false},
                magicType : {show: true, type: ['line', 'bar']},
                saveAsImage : {show: true}
            }
        },
        calculable : true,
        xAxis : [
            {
                type : 'category',
                data : ['Total','清澜','龙楼','不在位']
            }
        ],
        yAxis : [
            {
                type : 'value',
                name: '人数',
                nameTextStyle:{fontSize: 16, fontWeight: 900,},
                axisLabel:{show:false,fontSize: 12, fontFamily: 'Arial',},
                axisTick: {show:false,},
                axisLine: {show:false,},
            }
        ],
        series : [
            {
                name:'类型1',
                type:'bar',
                data:[15, 2.0, 4.9, 7.0],

            },
            {
                name:'类型2',
                type:'bar',
                data:[20,2.6, 5.9, 9.0],

            }
        ],
        color:['#007bff', '#ced4da'],
    };
    barChart.setOption(option);
</script>

<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
    $.widget.bridge('uibutton', $.ui.button)
</script>
<!-- 制定计划表 -->
<script>
    var editor;
    $(document).ready(function() {
        // $('#train-plan').DataTable({});
        // $('#technical-data').DataTable({});
        //
        // $('#plan_maker').DataTable({
        //     keys:true,
        //     serverSide: false,      // 是否开启服务器模式
        //                             // false时，会一次性查询所有的数据，dataTables帮我们完成分页等。
        //                             // true时，点击分页页码就会每次都到后台提取数据。
        // });
        editor = new $.fn.dataTable.Editor( {
            ajax:'{:url("admin/TrainPlan/getData")}',
            table:'#plan_list',
            idSrc: 'DT_RowId',
            fields:[
                {
                    label: '日期: ',
                    name: 'date',
                    // def: function () { return new Date(); },
                    type:  'datetime',
                    format: 'YYYY-MM-DD',
                    opts:  {
                        showWeekNumber: true
                    }
                }, {
                    label: '开始时间:',
                    name: 'start_time',
                    // def: function () { return new Date(); },
                    type:  'datetime',
                    format: 'HH:mm',
                    opts: {
                        minutesIncrement: 5
                    }
                }, {
                    label: '课时:',
                    name: 'duration',
                }, {
                    label: '类别:',
                    name:'category',
                    type:  "select",
                    options: [
                        { label: "共同训练", value: "1" },
                        { label: "专业技术训练", value: "2" },
                        { label: "其他训练", value: "3" }
                    ]
                }, {
                    label: '内容:',
                    name:'content'
                }, {
                    label: '组织方式:',
                    name:'organization'
                }, {
                    label: '应训人数',
                    name:'expt_par',
                    def: 30
                }, {
                    label: '负责人：',
                    name:'pers_in_char'
                }, {
                    label: '地点：',
                    name:'location'
                }, {
                    label: '备注：',
                    name:'remark'
                }],
            formOptions: {
                inline: {
                    onBlur: 'submit',
                    onReturn: 'submit',
                }
            }
        });

        // Buttons array definition to create previous, save and next buttons in
        // an Editor form
        var backNext = [
            {
                text: "&lt;",
                action: function (e) {
                    // On submit, find the currently selected row and select the previous one
                    this.submit( function () {
                        var indexes = table.rows( {search: 'applied'} ).indexes();
                        var currentIndex = table.row( {selected: true} ).index();
                        var currentPosition = indexes.indexOf( currentIndex );

                        if ( currentPosition > 0 ) {
                            table.row( currentIndex ).deselect();
                            table.row( indexes[ currentPosition-1 ] ).select();
                        }

                        // Trigger editing through the button
                        table.button( 1 ).trigger();
                    }, null, null, false );
                }
            },
            '提交',
            {
                text: "&gt;",
                action: function (e) {
                    // On submit, find the currently selected row and select the next one
                    this.submit( function () {
                        var indexes = table.rows( {search: 'applied'} ).indexes();
                        var currentIndex = table.row( {selected: true} ).index();
                        var currentPosition = indexes.indexOf( currentIndex );

                        if ( currentPosition < indexes.length-1 ) {
                            table.row( currentIndex ).deselect();
                            table.row( indexes[ currentPosition+1 ] ).select();
                        }

                        // Trigger editing through the button
                        table.button( 1 ).trigger();
                    }, null, null, false );
                }
            }
        ];

        var table = $('#plan_list').DataTable({
            dom: 'Bfrtip',
            rowId:'DT_RowId',
            ajax:{
                url: '{:url("admin/TrainPlan/getData")}',
                type: 'POST',
            },
            columns: [
                {
                    data: null,
                    defaultContent: '',
                    className: 'select-checkbox',
                    orderable: false,
                    searchable: false
                },
                {
                    data: 'date',
                    render: function ( data, type, row ) {
                        var dateSplit = data.split('-');
                        return type === "display" || type === "filter" ?
                            dateSplit[1] +'-'+ dateSplit[2]:
                            data;
                    },
                },
                {data: 'start_time'},
                {
                    data: 'duration',
                    orderable: false
                },
                {
                    data: 'category',
                    // 输出训练类别
                    render: function ( data, type, row) {
                        switch (data){
                            case '1': return '共同训练';
                            case '2': return '专业技术训练';
                            case '3': return '其他训练';
                        }
                    }
                },
                {
                    data: 'content',
                    orderable: false
                },
                {
                    data: 'organization',
                    orderable: false
                },
                {
                    data: 'expt_par',
                    orderable: false
                },
                {
                    data: 'pers_in_char',
                    orderable: false
                },
                {
                    data: 'location',
                    orderable: false
                },
                {
                    data: 'remark',
                    orderable: false
                },
            ],
            search:{
                search: ''
            },
            order: [[1, 'asc']],
            /*rowGroup: {
                dataSrc: 1
            },*/
            keys: {
                columns: ':not(:first-child)',
                keys:  [ "\t".charCodeAt(0) ],
                editor: editor,
                editOnFocus: true,
            },
            select: {
                style:    'os',
                selector: 'td:first-child'
            },
            buttons: [
                {
                    extend: "create",
                    editor: editor,
                    text: '新增'
                },
                {
                    extend: 'selected',
                    text:   '编辑',
                    action: function () {
                        var indexes = table.rows( {selected: true} ).indexes();

                        editor.edit( indexes, {
                            title: '编辑',
                            buttons: indexes.length === 1 ?
                                backNext :
                                'Save'
                        } );
                    }
                },
                {
                    extend: "remove",
                    editor: editor,
                    text: '删除'
                }
            ],
            serverSide: true,      // 是否开启服务器模式
            //                         // false时，会一次性查询所有的数据，dataTables帮我们完成分页等。
            //                         // true时，点击分页页码就会每次都到后台提取数据。
        });
        $('#addRow').on( 'click', function () {
            table.row.add( ).draw(  );
        } );
        table.buttons().container()
            .appendTo( $('.col-md-6:eq(0)', table.table().container() ) );
    });
</script>

<!-- 日登记 -->
<script>
    var editor;
    $(document).ready(function() {
        editor = new $.fn.dataTable.Editor( {
            ajax:'{:url("admin/DailyRecord/getData")}',
            table:'#daily_record',
            fields:[
                {
                    label: '日期: ',
                    name: 'date',
                    // def: function () { return new Date(); },
                    type:  'datetime',
                    format: 'YYYY-MM-DD',
                    opts:  {
                        showWeekNumber: true
                    }
                }, {
                    label: '类别:',
                    name:'category',
                    type:  "select",
                    options: [
                        { label: "共同训练", value: "1" },
                        { label: "专业技术训练", value: "2" },
                        { label: "其他训练", value: "3" }
                    ]
                }, {
                    label: '课时:',
                    name: 'duration',
                }, {
                    label: '内容:',
                    name:'content'
                }, {
                    label: '应训人数',
                    name:'expt_par',
                    def: 30
                }, {
                    label: '实际人数',
                    name: 'act_par',
                    def: 30
                }, {
                    label: '地点：',
                    name:'location'
                }, {
                    label: '备注：',
                    name:'remark'
                }],
            formOptions: {
                inline: {
                    onBlur: 'submit',
                    onReturn: 'submit',
                }
            }
        });

        var table = $('#daily_record').DataTable({
            dom: 'Bfrtip',
            ajax:{
                url: '{:url("admin/DailyRecord/getData")}',
                type: 'POST',
            },
            columns: [
                {
                    data: null,
                    defaultContent: '',
                    className: 'select-checkbox',
                    orderable: false,
                    searchable: false
                }, {
                    data: 'date',
                    render: function ( data, type, row ) {
                        var dateSplit = data.split('-');
                        return type === "display" || type === "filter" ?
                            dateSplit[1] +'-'+ dateSplit[2]:
                            data;
                    },
                }, {
                    data: 'category',
                    // 输出训练类别
                    render: function ( data, type, row) {
                        switch (data){
                            case '1': return '共同训练';
                            case '2': return '专业技术训练';
                            case '3': return '其他训练';
                        }
                    }
                }, {
                    data: 'duration',
                    orderable: false
                }, {
                    data: 'content',
                    orderable: false
                }, {
                    data: 'expt_par',
                    orderable: false
                }, {
                    data: 'act_par',
                    orderable: false
                }, {
                    data: 'location',
                    orderable: false
                }, {
                    data: 'remark',
                    orderable: false
                },
            ],
            search:{
                search: ''
            },
            order: [[1, 'asc']],
            /*rowGroup: {
                dataSrc: 1
            },*/
            keys: {
                columns: ':not(:first-child)',
                keys:  [ "\t".charCodeAt(0) ],
                editor: editor,
                editOnFocus: true,
            },
            select: {
                style:    'os',
                selector: 'td:first-child'
            },
            buttons: [
                {
                    extend: "create",
                    editor: editor,
                    text: '新增'
                },
                {
                    extend: 'selected',
                    text:   '编辑',
                    action: function () {
                        var indexes = table.rows( {selected: true} ).indexes();

                        editor.edit( indexes, {
                            title: '编辑',
                            buttons: indexes.length === 1 ?
                                backNext :
                                'Save'
                        } );
                    }
                },
                {
                    extend: "remove",
                    editor: editor,
                    text: '删除'
                }
            ],
            serverSide: true,      // 是否开启服务器模式
            //                         // false时，会一次性查询所有的数据，dataTables帮我们完成分页等。
            //                         // true时，点击分页页码就会每次都到后台提取数据。
        });
        $('#addRow').on( 'click', function () {
            table.row.add( ).draw(  );
        } );
        table.buttons().container()
            .appendTo( $('.col-md-6:eq(0)', table.table().container() ) );
    });
</script>

<script>
    //iCheck for checkbox and radio inputs
    $('input[type="checkbox"].minimal, input[type="radio"].minimal').iCheck({
        checkboxClass: 'icheckbox_minimal-blue',
        radioClass   : 'iradio_minimal-blue'
    })
    //Red color scheme for iCheck
    $('input[type="checkbox"].minimal-red, input[type="radio"].minimal-red').iCheck({
        checkboxClass: 'icheckbox_minimal-red',
        radioClass   : 'iradio_minimal-red'
    })
    //Flat red color scheme for iCheck
    $('input[type="checkbox"].flat-red, input[type="radio"].flat-red').iCheck({
        checkboxClass: 'icheckbox_flat-green',
        radioClass   : 'iradio_flat-green'
    })
</script>

<script>
    //Initialize Select2 Elements
    $('.select2').select2({
        theme: "classic"
    })
</script>

<script>
    $('#reservationtime').daterangepicker({
        timePicker         : true,
        timePickerIncrement: 30,
        format             : 'MM/DD/YYYY h:mm A'
    })
</script>
